{% comment %}
  Shared template for Element selection logic
  This file calculates which element to display based on user configuration:
  - Daily Rotation: Cycles through all 118 elements based on day of year
  - Hourly Random: Shows a different element each hour based on hour identifier
{% endcomment %}

{% comment %}
  Load elements array from static data (data-all.json)
  The 'elements' key is automatically available from the static data configuration
{% endcomment %}
{% assign all_elements = elements %}

{% comment %} Get user's display mode preference (daily or hourly) {% endcomment %}
{% assign display_mode = trmnl.plugin_settings.custom_fields_values.display_mode | default: "daily" %}

{% if display_mode == "hourly" %}
  {% comment %} Hourly mode: Calculate element based on current hour {% endcomment %}
  {% assign current_year = "now" | date: "%Y" %}
  {% assign current_month = "now" | date: "%m" %}
  {% assign current_day = "now" | date: "%d" %}
  {% assign current_hour = "now" | date: "%H" %}
  {% assign hour_identifier = current_year | append: current_month | append: current_day | append: current_hour %}
  {% assign hour_id_number = hour_identifier | plus: 0 %}
  {% assign total_elements = all_elements | size %}
  {% assign element_index = hour_id_number | modulo: total_elements %}
{% else %}
  {% comment %} Daily mode: Calculate element based on day of year (default) {% endcomment %}
  {% assign current_date = "now" | date: "%s" %}
  {% assign year_start = "now" | date: "%Y-01-01" | date: "%s" %}
  {% assign seconds_diff = current_date | minus: year_start %}
  {% assign day_of_year = seconds_diff | divided_by: 86400 | plus: 1 %}
  {% assign total_elements = all_elements | size %}
  {% assign element_index = day_of_year | modulo: total_elements %}
{% endif %}

{% comment %}
  DEV TESTING: Override element_index to test specific elements
  Uncomment the line below and set to desired element index (0-117) to test specific elements
  Examples:
  - Element 99 (Einsteinium, 252.0830): {% assign element_index = 98 %}
  - Element 100 (Fermium, 257.09511): {% assign element_index = 99 %}
  - Element 101 (Mendelevium, 258.09843): {% assign element_index = 100 %}
  - Element 102 (Nobelium, 259.10100): {% assign element_index = 101 %}
  - Element 59 (Praseodymium, long name): {% assign element_index = 58 %}
  - Element 104 (Rutherfordium, longest name): {% assign element_index = 103 %}
  
  To disable override: Simply comment out or delete the override line below
{% endcomment %}
{% comment %} {% assign element_index = 99 %} {% endcomment %}

{% comment %} Get the element for this period {% endcomment %}
{% assign element = all_elements[element_index] %}

{% comment %}
  The 'element' variable is now available with the following properties:
  - element.atomic_number
  - element.symbol
  - element.name
  - element.atomic_mass
  - element.cpk_hex_color
  - element.electron_configuration
  - element.electronegativity
  - element.atomic_radius
  - element.ionization_energy
  - element.electron_affinity
  - element.oxidation_states
  - element.standard_state
  - element.melting_point
  - element.boiling_point
  - element.density
  - element.category
  - element.year_discovered
{% endcomment %}
